---
title: "<code style='background:none;font-size:1.1em'>library(<strong>highcharter</strong>)</code><br>¡De principiante a experto!"
subtitle: "Latin<strong>R</strong><br>Santiago, CL - Septiembre 2019"
author: "Joshua Kunst & Ignacio Rossi"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "metropolis", "metropolis-fonts", "assets/custom.css"]
    nature:
      # ratio: "16:9"
      ratio: "4:3"
      selfcontained: true
      # highlightStyle: solarized-light
      # highlightLines: true
      countIncrementalSlides: false
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

class: clear, right, bottom
background-image: url("img/trip.jpg")
background-size: cover

# Antes de Partir

---

# Como seguir el taller


- Descargar el proyecto R-Studio https://bit.ly/2kGGltk (comprimido)
- Descomprimir, yay!
- Abrir el proyecto
- Códigos y ejercicios en carpeta `R`
- Slides en la ruta `slides/index.html` o versión online de las 
slides en http://jkunst.com/LatinR-2019-Highcharter-taller/slides/ 
- En las slides lo que aparezca de `esta forma` indica que es código (generalmente)

---

# Evitar errores usuales


- Siempre correr los scripts en orden: línea por línea
- ¡Sí! Comenzando por la primera
- En caso de <code style="color:red">Warning: ... </code>, es un
warning no más, nada grave.
- En caso de <code style="color:red">Error ... </code>, leerlo con calma y en
caso de no poder solucionarlo levantar la manto para ser socorrido

---

# Los paquetes

Necesitaremos de tidyverse: `dplyr` y `purrr` en algunos casos para
manipulación de datos.

```{r, message=FALSE, warning=FALSE}
if(!require(tidyverse))       install.packages("tidyverse")
if(!require(datos))           install.packages("datos")
if(!require(tradestatistics)) install.packages("tradestatistics")
if(!require(highcharter))     install.packages("highcharter")

library(tidyverse)
library(datos)
library(tradestatistics)
library(datos)


# y lo más importante supongo :P
library(highcharter)
```


---

# Prueba de fuego

```{r}
highcharts_demo()
```


---

class: clear, middle, left
background-image: url("img/strc.jpg")
background-size: cover

# Estructura<br>taller


---

# Temas

- ¿Por que la visualización? (y algunos tips que he aprendido [con errores])
- Highcharts y `highcharter` 
- Función `hchart`
- ¡Ayuda! y documentación
- Siempre con estilo
- Todo mejora con tooltips
- Mapas
- Integración con `shiny` y `rmarkdown`
- Esto no termina aquí: ¡Otros htmlwidgets!


---

class: clear, middle, inverse
background-image: url("img/dataviz2.png")

# ¿Por qué<br>visualización?

---

background-image: url("img/chn.png")
background-size: normal

# ¿Alguien entiende?

---

background-image: url("img/russianr4ds.jpg")
background-size: cover

# Lenguaje común


---

class: clear, center, middle, inverse
background-image: url("img/hc.gif")
background-size: cover

# <span id="brand">h|1i|0g|3h|2c|1h|2a|1r|3t|2e|1r</span>

---

# HighchartsJS & Highcharter

- HighchartsJS es una librería javascript (como plotly, apexcharts, eCharts)
- Highcharter es apenas un _wrapper_ de R para highcharts...
- Es decir poder usar highchartsJS desde R sin saber _necesariamente_ javascript


https://www.highcharts.com/demo

![](img/highcharts.png)

---

class: clear, middle, right 
background-image: url("img/magic.jpg")
background-size: cover

# hchart


---

# hchart

- `hchart` es una función ~~mágica~~ genérica (similar a `plot`)
- Dependiendo de la clase del objeto graficará algo particular
- Interactividad con una línea de código

---

# Antes de graficar!

Yo procederé a cambiar el tema por default de highcharts que 
no me gusta mucho:

```{r}
options(highcharter.theme = hc_theme_smpl())
```

Usted puede buscar su favorito, por ejemplo:

```{r, eval=FALSE}
options(highcharter.theme = hc_theme_ggplot2())
```

Más variedad en http://jkunst.com/highcharts-themes-collection/



---

# Datos a probar

```{r}
diamantes
```

---

# Variables numéricas

```{r}
hchart(diamantes$precio, name = "Precio")
```

---

# Factores

```{r}
hchart(diamantes$corte, name = "Corte", color = "#509EF4")
```

---

# Series temporales

```{r}
data("AirPassengers")
hchart(AirPassengers, showInLegend = FALSE, name = "Pasajeros")
```

---

# Matrices (correlaciones o distancias)

```{r}
corcar <- cor(tibble::column_to_rownames(datos::mtautos, "modelo"))
hchart(corcar)
```

---

class: clear, center

<iframe src="https://giphy.com/embed/12NUbkX6p4xOO4" width="480" height="440" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p><a href="https://giphy.com/gifs/shia-labeouf-12NUbkX6p4xOO4">via GIPHY</a></p>

---

# ¡Y más!

- Data frames, densidades
- Paquetes `igraph`, `survival`, `quantmod` 
- Componentes principales
- Ver ejemplos en http://jkunst.com/highcharter/hchart.html

---

# Tiempo de _codear_

¡Ahora usted!

Revisemos el archivo `R/01-hchart.R`

---

# hchart en data frames

- El caso de data frame es particular
- Pues en una data frame (tabla) pueden existir varias columnas las cuales
querríamos representar o no visualmente en un gráfico
- Por lo que debemos _hacer el esfuerzo_ de mencionar comos queremos
_mapear_ las variables (y que variables) 
- Y obviamente mencionar el tipo de representación (tipo de gráfico)
a usar.
- En data frames `hchart` funciona relativamente parecido a `ggplot2`

---

# ¿Qué es esto de _mapear_?

Por ejemplo para graficar un punto debemos decirle a `R` la posición `x`, `y` y 
tamaño si quisiéramos:

.center[![](img/4_bubble-chart_mapping-vars.png)]

https://www.sharpsightlabs.com/blog/r-package-think-about-visualization/
https://rpubs.com/JoanClaverol/405488

---

# Devuelta a hchart

```{r}
hchart(millas, "point", hcaes(x = ciudad, y = autopista, group = clase))
```


---

# Tiempo de _codear_ nuevamente

¿De nuevo? Buuu!

Revisemos el archivo `R/02-dataframes.R`

---

---

# Créditos imágenes

https://500px.com/photo/43752970/Mount-Fitzroy-at-sunset-by-Jimmy-Mcintyre


